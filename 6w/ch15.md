# CH15, 타임 라인 격리하기

## 타임 라인 다이어그램 기본 규칙

- 액션 순서대로 타임 라인에 넣기
  - 타임 라인에는 액션만 넣기, 계산은 실행 시점에 영향을 안받기 때문에 넣을 필요 X
- 동시 실행 || 순서 예상이 불가능하다면 타임 라인을 나누어 넣기
  - 해당 액션은 서로 다른 스레드나 프로세스에서 실행 되는 만큼 어떤 액션이 먼저 실행 되는지 알 수 없음!

## 순서가 섞이는 코드 vs 순서가 섞이지 않는 코드

- 순서가 섞일 수 있는 코드 : 액션이 각각 실행되는 코드(비동기 코드)
  - 스레드에 의해 동시 실행이 되므로, 어떤 액션이 먼저 끝날지 알 수 없다
- 순서가 섞일 수 없는 코드 : 액션이 순차적으로 실행되는 코드(동기화 처리 된 코드)
  - 하나의 액션이 끝나야, 다음 액션이 실행 되므로 순서가 섞이지 않는다
- 따라서 액션이 각각 다른 타임에 나열 되어있고, 해당 높이가 달라도 액션의 실행 시점과 종료 시점을 알 수 없으므로 차이가 없는 것과 동일하다

## 좋은 타임 라인의 원칙

1. 타임라인은 적을 수록 좋다
2. 타임라인은 짧을 수록 좋다
3. 공유하는 자원이 적을 수록 좋다
4. 자원을 공유할 경우 서로 조율이 되어야 한다
5. 시간을 일급(first-class)로 다룬다

## AJAX(Asynchronous Js And Xml)와 이벤트 큐

- AJAX 요청이 들어가면 이벤트 루프 이외에 네트워크 엔진이 추가되어 AJAX 요청을 작업 큐에 넣는 역할을 한다
- AJAX 요청이 완료 되면 네트워크 엔진이 AJAX 에 대한 콜백을 다시 작업 큐에 추가하여 요청을 완료하는 구조

## 타임 라인 단순화

1. 비동기 액션이 발생하면 점선으로 타임라인을 분리하기
2. 같은 타임라인에 있는 액션(순서가 섞이지 않는)은 하나로 통합하여 단순화 하기
3. JS 는 싱글 스레드이기 때문에 동시에 실행되는 가능성이 없다 -> 따라서 단순화가 쉽다
4. 3에 의해 타임 라인이 '끝나고' 새로운 타임 라인 시작 된다면 하나로 통합하기가 가능해짐

### 타임 라인을 쉽게 만드는 네 가지 원칙

1. 적은 타임 라인
2. 짧은 타임 라인
3. 적은 공유 자원
4. 자원 공유가 발생하면 조율하기

## 자원 공유하는 타임 라인 문제점 해결하기

1. 전역 변수를 지역 '변수'로 변경 -> 지역 변수에 대한 처리는 액션이 아니라 계산이므로 타임 라인에서 빠질 수 있다
2. 전역 변수를 '인자'로 변경 -> 전역 변수를 인자로 변경하여, 추후 액션은 콜백 이후에 다시 읽도록 변경 -> 타임 라인에서 항상 자원이 동시에 공유가 되지 않고 순서대로 실행 가능

\*\* [p. 433] 아무리 봐도 함수형 코딩의 최대 장점을 쉬운 개념으로 어필 할 수 있는 언어가 JS 인 것 같습니다 ㅋㅋㅋㅋㅋ
\*\* [p. 434] 7번은 JS 기준으로는 F 아닌가요? 싱글 스레드라서 동시에 실행은 JS 에서 불가능 합니다(p. 420 참조)
